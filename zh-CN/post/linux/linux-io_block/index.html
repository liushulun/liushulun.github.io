<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)">
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicon-16x16.png">
  <link rel="mask-icon" href="/assets/images/favicon-logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.css" integrity="sha256-gkQVf8UKZgQ0HyuxL/VnacadJ+D2Kox2TCEBuNQg5+w=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/orange/pace-theme-flash.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"luisliu.cn","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12,"reverse":true},"copycode":{"enable":true,"style":"mac"},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":true,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":true,"motion":{"enable":false,"async":true,"transition":{"menu_item":null,"post_block":"fadeInDown","post_header":null,"post_body":null,"coll_header":null,"sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":5,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="（1）进程的同步异步、阻塞非阻塞概念；（2）进程切换；（3）进程间通信模型；（4）Java 中的 BIO、NIO。">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux-IO阻塞模型">
<meta property="og:url" content="https://luisliu.cn/zh-CN/post/linux/linux-io_block/index.html">
<meta property="og:site_name" content="LuisLiu">
<meta property="og:description" content="（1）进程的同步异步、阻塞非阻塞概念；（2）进程切换；（3）进程间通信模型；（4）Java 中的 BIO、NIO。">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2021-08-24T06:47:53.000Z">
<meta property="article:author" content="LuisLiu">
<meta property="article:tag" content="Linux">
<meta property="article:tag" content="IO">
<meta property="article:tag" content="同步">
<meta property="article:tag" content="异步">
<meta property="article:tag" content="阻塞">
<meta property="article:tag" content="非阻塞">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://luisliu.cn/zh-CN/post/linux/linux-io_block/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://luisliu.cn/post/linux/linux-io_block/","path":"zh-CN/post/linux/linux-io_block/","title":"Linux-IO阻塞模型"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Linux-IO阻塞模型 | LuisLiu</title>
  














<script>
    <!--动态浏览器标签-->
    const ORIGINAL_TITLE = document.title;
    const WELCOME_TITLE = "Welcome Back!";
    const ANIM_TAB_TITLE_HALF_SPACE_CHAR = "\u2002";
    const ANIM_TAB_TITLE_FULL_SPACE_CHAR = "\u3000";
    const ANIM_TAB_TITLE_SHOW_INTERVAL = 50;
    const ANIM_TAB_TITLE_SHOW_STAY = 500;
    const timerSet = new Set();
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            clearTimerSet();

            // $('[rel="icon"]').attr('href', "/images/favicon-32x32-next.png");
            var faviconLink = document.querySelectorAll('[rel="icon"]');
            if (faviconLink != null) {
                faviconLink.href = "/images/favicon-32x32-next.png";
            }
            // 失去焦点时不切换标题
            // document.title = "Waiting...";
            document.title = ORIGINAL_TITLE;
        } else {
            document.title = "";
            showTabTitleAnim(WELCOME_TITLE);
        }
    });

    function showTabTitleAnim(titleText) {
        if (titleText == ORIGINAL_TITLE) {
            clearTimerSet();
            document.title = ORIGINAL_TITLE;
            return;
        }
        const showingLength = (document.title == null) ? 0 : document.title.length;
        if (showingLength >= titleText.length) {
            var timer = setTimeout(function() {
                clearTimerSet();
                document.title = ORIGINAL_TITLE;
            }, ANIM_TAB_TITLE_SHOW_STAY);
            timerSet.add(timer);
        } else {
            const nextChar = titleText[showingLength];
            if (nextChar.trim().length <= 0) {
                // document.title 无法以空格结尾（会被自动删除），导致死循环一直追加空格，必须用专门的空白字符替代。
                document.title += ANIM_TAB_TITLE_HALF_SPACE_CHAR;
                showTabTitleAnim(titleText);
                return;
            }
            document.title += nextChar;
            var timer = setTimeout(function() {
                timerSet.delete(timer);
                showTabTitleAnim(titleText);
            }, ANIM_TAB_TITLE_SHOW_INTERVAL);
            timerSet.add(timer);
        }
    }

    function clearTimerSet() {
        timerSet.forEach(function(value, key, set) {
            clearTimeout(value);
        });
        timerSet.clear();
    }
</script>




<script>
    Pace.options.eventLag = false;
    document.addEventListener("readystatechange", () => {
        if (document.readyState === "interactive") {
            // Do fancy stuff like not pace.js related stuff (animations etc).
        } else if (document.readyState === "complete") {
            // Force all animation to finish.
            Pace.stop();
            // Hide pace elements.
            //document
            //    .querySelector("#pace-content")
            //    .classList.replace("opacity-0", "opacity-100");
        }
    });
</script>





  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">LuisLiu</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">2025/09/10 - 02:34:15</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-th-large fa-fw"></i>关于</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档<span class="badge">82</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类<span class="badge">14</span></a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签<span class="badge">153</span></a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>


</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux-IO%E9%98%BB%E5%A1%9E%E6%A8%A1%E5%9E%8B"><span class="nav-text">Linux-IO阻塞模型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%90%8C%E6%AD%A5%E5%BC%82%E6%AD%A5%E5%8F%8A%E9%98%BB%E5%A1%9E%E9%9D%9E%E9%98%BB%E5%A1%9E"><span class="nav-text">1. 同步异步及阻塞非阻塞</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%BF%9B%E7%A8%8B%E5%88%87%E6%8D%A2"><span class="nav-text">2. 进程切换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1%E7%9A%84%E6%A8%A1%E5%9E%8B"><span class="nav-text">3. 进程间通信的模型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%90%8C%E6%AD%A5%E9%98%BB%E5%A1%9EBIO"><span class="nav-text">3.1 同步阻塞BIO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E5%90%8C%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9ENIO"><span class="nav-text">3.2 同步非阻塞NIO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-%E5%90%8C%E6%AD%A5%E4%BF%A1%E5%8F%B7%E9%A9%B1%E5%8A%A8"><span class="nav-text">3.3 同步信号驱动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-%E5%90%8C%E6%AD%A5IO%E5%A4%9A%E8%B7%AF%E5%A4%8D%E7%94%A8"><span class="nav-text">3.4 同步IO多路复用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-%E5%BC%82%E6%AD%A5%E9%9D%9E%E9%98%BB%E5%A1%9EAIO"><span class="nav-text">3.5 异步非阻塞AIO</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Java%E4%B8%AD%E7%9A%84IO"><span class="nav-text">4. Java中的IO</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-BIO"><span class="nav-text">4.1 BIO</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-NIO"><span class="nav-text">4.2 NIO</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%8C%AE"><span class="nav-text">参考文献</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="LuisLiu"
      src="/assets/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">LuisLiu</p>
  <div class="site-description" itemprop="description">Keep Learning</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">153</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="/" title="Home → &#x2F;" rel="noopener me"><i class="fa fa-home fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://github.com/liushulun" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;liushulun" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="http://sighttp.qq.com/authd?IDKEY=50d1f9647e1441567ff941b646b66c8053449b2557ca041d" title="Chats → http:&#x2F;&#x2F;sighttp.qq.com&#x2F;authd?IDKEY&#x3D;50d1f9647e1441567ff941b646b66c8053449b2557ca041d" rel="noopener me" target="_blank"><i class="fab fa-qq fa-fw"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:luisio@foxmail.com" title="E-Mail → mailto:luisio@foxmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i></a>
      </span>
  </div>



<script>
    const ANIM_SIDEBAR_TEXT_SHOW_INTERVAL = 30;
    const ANIM_SIDEBAR_TEXT_SHOW_STAY = 5000;
    const ANIM_SIDEBAR_TEXT_HIDE_INTERVAL = 15;
    const ANIM_SIDEBAR_TEXT_HIDE_STAY = 1000;
    const ANIM_SIDEBAR_CURSOR_INTERVAL = 500;

    const ANIM_SIDEBAR_TEXT_SET = [`Welcome!`,
                       `Feel free.`,
                       `Keep learning!`,
                       `Good luck!`,
                       `Nice to meet you.`,
                       `Does anything interest you?`,
                       `Let's exchange the friend-link!`,
                       `Comment will be available soon.`,
                       `Can't wait to chat with you!`,
                       ];
    var currentAnimText = ANIM_SIDEBAR_TEXT_SET[0];

    function genRandomSidebarText(minVal, maxVal) {
        switch (arguments.length) {
            case 1: {
                return parseInt(Math.random() * minVal, 10); // parseInt 约等于 floor 都是向下取整，第二个参数表示 10 进制
            }
            case 2: {
                return parseInt((Math.random() * (maxVal - minVal)) + minVal, 10);
            }
            default: {
                return 0;
            }
        }
    }

    function startSidebarTextAnim(textNode) {
        if (textNode == null) {
            return;
        }
        showSidebarTextAnim(textNode);
    }

    function startSidebarTextCursorAnim(cursorNode) {
        if (cursorNode == null) {
            return;
        }
        setTimeout(function() {
            if (cursorNode.style.color == 'transparent') {
                cursorNode.style.color = '#999999';
            } else {
                cursorNode.style.color   = 'transparent';
            }
            startSidebarTextCursorAnim(cursorNode);
        }, ANIM_SIDEBAR_CURSOR_INTERVAL);
    }

    function showSidebarTextAnim(textNode) {
        if (textNode == null) {
            return;
        }
        const showingLength = (textNode.innerHTML == null) ? 0 : textNode.innerHTML.length;
        if (showingLength < currentAnimText.length) {
            const nextChar = currentAnimText[showingLength];
            textNode.innerHTML += nextChar;
            if (nextChar.trim().length <= 0) {
                showSidebarTextAnim(textNode);
                return;
            }
            setTimeout(function() {
                showSidebarTextAnim(textNode);
            }, ANIM_SIDEBAR_TEXT_SHOW_INTERVAL);
        } else {
            setTimeout(function() {
                hideSidebarTextAnim(textNode);
            }, ANIM_SIDEBAR_TEXT_SHOW_STAY);
        }
    }

    function hideSidebarTextAnim(textNode) {
        if (textNode == null) {
            return;
        }
        const showingLength = (textNode.innerHTML == null) ? 0 : textNode.innerHTML.length;
        if (showingLength > 0) {
            textNode.innerHTML = textNode.innerHTML.slice(0, -1);
            setTimeout(function() {
                hideSidebarTextAnim(textNode);
            }, ANIM_SIDEBAR_TEXT_HIDE_INTERVAL);
        } else {
            // 所有文字都隐藏后，重新随机选择一个文案。
            // 随机选择时，如果新随机到的文案与上一次的相同，则重新随机一次，最多重试 3 次。
            for (var i = 0; i < 3; i++) {
                let randomTextIndex = genRandomSidebarText(ANIM_SIDEBAR_TEXT_SET.length);
                let randomText = ANIM_SIDEBAR_TEXT_SET[randomTextIndex];
                if (randomText.trim().length <= 0) {
                    continue;
                }
                if (currentAnimText !== randomText) {
                    currentAnimText = randomText;
                    break;
                }
            }
            setTimeout(function() {
                showSidebarTextAnim(textNode);
            }, ANIM_SIDEBAR_TEXT_HIDE_STAY);
        }
    }


    // 创建 Observer，用于监听指定节点及其子节点的所有变化。
    const siteAuthorObserver = new MutationObserver(function() {
        // 找到所有符合 SiteAuthor（包含头像、名称、描述）特征的节点（<div class="site-author">）：
        const allFoundParents = document.getElementsByClassName('site-author');
        if (allFoundParents.length <= 0) {
            // Do nothing, keep observing.
            return;
        }

        // 确保找到的 SiteAuthor 是 Sidebar 内的元素：
        var parentNode = null;
        for (var i = 0; i < allFoundParents.length; i++) {
            const eachNode = allFoundParents[i];
            if (eachNode.parentNode != null && eachNode.parentNode.classList.contains('site-overview-wrap') && eachNode.parentNode.classList.contains('sidebar-panel')) {
                parentNode = eachNode;
                break;
            }
        }
        if (parentNode == null) {
            return;
        }

        siteAuthorObserver.disconnect();

        // 遍历 SiteAuthor 的子元素，找到 SiteDescription 元素：
        var anchorNode = null;
        for (var i = 0; i < parentNode.children.length; i++) {
            const eachNode = parentNode.children[i];
            if (eachNode.classList.contains('site-description')) {
                anchorNode = eachNode;
                break;
            }
        }
        if (anchorNode == null) {
            return;
        }

        // 清空 SiteDescription 元素：
        while (anchorNode.children.length > 0) {
            anchorNode.children[0].remove();
        }
        anchorNode.innerHTML = null;
        anchorNode.innerText = null;

        //
        const containerDiv = document.createElement('div');
        containerDiv.setAttribute('id', "containerDiv");
        containerDiv.setAttribute('style', "padding:5px 0px; margin:0px; text-align:center; display:flex; justify-content:center; line-height:1; font-size:1.0em!important; min-height:1.0em!important;");
        //parent.insertBefore(containerDiv, parent.firstChild);
        anchorNode.insertBefore(containerDiv, anchorNode.firstChild);
        //
        const textDiv = document.createElement('div');
        textDiv.setAttribute('style', "padding:0px; margin:0px;");
        startSidebarTextAnim(textDiv);
        containerDiv.appendChild(textDiv);
        //
        const cursorDiv = document.createElement('div');
        cursorDiv.setAttribute('style', "padding:0px; margin:0px;");
        cursorDiv.innerHTML = '|';
        startSidebarTextCursorAnim(cursorDiv);
        containerDiv.appendChild(cursorDiv);
    });
    siteAuthorObserver.observe(document, {
        childList: true,
        subtree: true
    });

    document.addEventListener('DOMContentLoaded', function() {
        // 所有 DOM(Document Object Model) 加载完成后，不论 siteAuthorObserver 是否监听到，都需要取消监听。
        siteAuthorObserver.disconnect();
    });
</script>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://luisliu.cn/post/linux/linux-io_block/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/assets/images/avatar.jpg">
      <meta itemprop="name" content="LuisLiu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="LuisLiu">
      <meta itemprop="description" content="Keep Learning">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Linux-IO阻塞模型 | LuisLiu">
      <meta itemprop="description" content="（1）进程的同步异步、阻塞非阻塞概念；（2）进程切换；（3）进程间通信模型；（4）Java 中的 BIO、NIO。">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Linux-IO阻塞模型
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-08-24 14:47:53" itemprop="dateCreated datePublished" datetime="2021-08-24T14:47:53+08:00">2021-08-24</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
        </span>
    </span>

  


  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="far fa-tags"></i>
    </span>
    <span class="post-meta-item-text">Tags:</span>
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/tags/Linux/" itemprop="url" rel="tag"><span itemprop="name">Linux</span></a>
      </span>
        ，
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/tags/IO/" itemprop="url" rel="tag"><span itemprop="name">IO</span></a>
      </span>
        ，
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/tags/%E5%90%8C%E6%AD%A5/" itemprop="url" rel="tag"><span itemprop="name">同步</span></a>
      </span>
        ，
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/tags/%E5%BC%82%E6%AD%A5/" itemprop="url" rel="tag"><span itemprop="name">异步</span></a>
      </span>
        ，
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/tags/%E9%98%BB%E5%A1%9E/" itemprop="url" rel="tag"><span itemprop="name">阻塞</span></a>
      </span>
        ，
      <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
        <a href="/tags/%E9%9D%9E%E9%98%BB%E5%A1%9E/" itemprop="url" rel="tag"><span itemprop="name">非阻塞</span></a>
      </span>
  </span>


    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>8.1k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>9 分钟</span>
    </span>
</div>

            <div class="post-description">（1）进程的同步异步、阻塞非阻塞概念；（2）进程切换；（3）进程间通信模型；（4）Java 中的 BIO、NIO。</div>
        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">




    <script>
        // 目前有一键回顶部和一键去底部按钮，暂时不启用文章的顶部导航：
        // insertHeaderNavigation();

        function insertHeaderNavigation() {
            const postHeaderDiv = document.querySelectorAll('.post-header')[0];
            if (postHeaderDiv == null) {
                return;
            }
            const isNavigationEnabled = "right";
            if (!isNavigationEnabled) {
                return;
            }

            // 不知道为什么，直接获取 post.next 会导致 post.njk 渲染失败，但是又能直接读属性。。。
            
            
            const isNextPostAtRight = ("right" === 'right');
            var leftPostTitle, leftPostPath, rightPostTitle, rightPostPath;
            if (isNextPostAtRight) {
                leftPostTitle = "Android-触摸事件";
                leftPostPath = "post/android/android-touch_event/";
                rightPostTitle = "Android-Binder";
                rightPostPath = "post/android/android-binder/";
            } else {
                leftPostTitle = "Android-Binder";
                leftPostPath = "post/android/android-binder/";
                rightPostTitle = "Android-触摸事件";
                rightPostPath = "post/android/android-touch_event/";
            }
            const leftPostRelatedUrl = "/" + leftPostPath;
            const rightPostRelatedUrl = "/" + rightPostPath;
            if ((leftPostPath == null || leftPostPath.length <= 0) && (rightPostPath == null || rightPostPath.length <= 0)) {
                return;
            }

            var headerNavDiv = document.createElement('div');
            headerNavDiv.className = 'post-nav';
            // 反转 style-border 样式：
            headerNavDiv.style.borderTop = "none";
            headerNavDiv.style.borderBottom = "1px solid #808080";
            // 反转 style-margin 样式：
            headerNavDiv.style.marginTop = "-20px";
            // headerNavDiv.style.marginBottom = "1em";
            headerNavDiv.style.marginBottom = "80px";
            // 反转 style-padding 样式：
            headerNavDiv.style.padding = "0 5px 10px";
            postHeaderDiv.insertBefore(headerNavDiv, postHeaderDiv.firstChild);

            if (leftPostPath != null && leftPostPath.length > 0) {
                var headerNavLeftDiv = document.createElement('div');
                headerNavLeftDiv.className = 'post-nav-item';
                headerNavDiv.append(headerNavLeftDiv);

                var headerNavLeftLink = document.createElement('a');
                headerNavLeftLink.title = leftPostTitle;
                headerNavLeftLink.href = leftPostRelatedUrl;
                headerNavLeftLink.rel = "prev";
                headerNavLeftLink.style.textAlign = "left";
                headerNavLeftDiv.append(headerNavLeftLink);

                var headerNavLeftIcon = document.createElement('i');
                headerNavLeftIcon.className = 'fa fa-angle-left';
                headerNavLeftLink.append(headerNavLeftIcon);

                var headerNavLeftTitleNode = document.createTextNode(leftPostTitle);
                headerNavLeftLink.append(headerNavLeftTitleNode);
            }
            if (rightPostPath != null && rightPostPath.length > 0) {
                var headerNavRightDiv = document.createElement('div');
                headerNavRightDiv.className = 'post-nav-item';
                headerNavDiv.append(headerNavRightDiv);

                var headerNavRightLink = document.createElement('a');
                headerNavRightLink.title = rightPostTitle;
                headerNavRightLink.href = rightPostRelatedUrl;
                headerNavRightLink.rel = "next";
                headerNavRightLink.style.textAlign = "right";
                headerNavRightDiv.append(headerNavRightLink);

                var headerNavRightTitleNode = document.createTextNode(rightPostTitle);
                headerNavRightLink.append(headerNavRightTitleNode);

                var headerNavRightIcon = document.createElement('i');
                headerNavRightIcon.className = 'fa fa-angle-right';
                headerNavRightLink.append(headerNavRightIcon);
            }
        }
    </script>
<span id="more"></span>

<h1 id="Linux-IO阻塞模型"><a href="#Linux-IO阻塞模型" class="headerlink" title="Linux-IO阻塞模型"></a>Linux-IO阻塞模型</h1><p>通常，对于进程间的通信有两对常见的概念：同步和异步、阻塞和非阻塞，但实际上对于通信过程中的发送进程和接收进程而言，这两对概念是同义词，只有站在一个完整的进程间通信流程的角度，才会具有不同性质。</p>
<h2 id="1-同步异步及阻塞非阻塞"><a href="#1-同步异步及阻塞非阻塞" class="headerlink" title="1. 同步异步及阻塞非阻塞"></a>1. 同步异步及阻塞非阻塞</h2><p>从《操作系统概念》中节选出有关进程通信的部分：</p>
<blockquote>
<p>3.4.2.2 Synchronization</p>
<p>Communication between processes takes place through calls to send() and receive() primitives. There are different design options for implementing each primitive. Message passing may be either <strong>blocking</strong> or <strong>nonblocking</strong> -- also known as <strong>synchronous</strong> and <strong>asynchronous</strong>. (Throughout this text, you will encounter the concepts of synchronous and asynchronous behavior in relation to various operating-system algorithms.)</p>
<ul>
<li>Blocking send. The sending process is blocked until the message is received by the receiving process or by the mailbox.</li>
<li>Nonblocking send. The sending process sends the message and resumes operation.</li>
<li>Blocking receive. The receiver blocks until a message is available.</li>
<li>Nonblocking receive. The receiver retrieves either a valid message or a null.</li>
</ul>
<p>Different combinations of send() and receive() are possible. When both send() and receive() are blocking, we have a rendezvous between the sender and the receiver. The solution to the producer-consumer problem becomes trivial when we use blocking send() and receive() statements. The producer merely invokes the blocking send() call and waits until the message is delivered to either the receiver or the mailbox. Likewise, when the consumer invokes receive(), it blocks until a message is available. This is illustrated in Figures 3.15 and 3.16.</p>
</blockquote>
<p>大致含义为：</p>
<p>进程间通信通过 <code>send()</code> 发送和 <code>receive()</code> 接收两种操作完成，这两种操作可能存在多种实现方案。消息在进程间传递时有可能是 <strong>阻塞</strong> 或 <strong>非阻塞</strong> 的，也被称为 <strong>同步</strong> 和 <strong>异步</strong>。</p>
<ul>
<li>Blocking Send 阻塞发送：发送方发送消息后将一直阻塞，直到接收方收到消息。</li>
<li>Nonblocking Send 非阻塞发送：发送方将消息发出后就处理其他任务，不论消息是否被接收方收到。</li>
<li>Blocking Receive 阻塞接收：接收方调用 <code>receive()</code> 后将一直阻塞，直到收到一条可用消息。</li>
<li>Nonblocking Receive 非阻塞接收：接收方调用 <code>receive()</code> 后将立即获得一条可用消息，或是一个空值，而不会阻塞。</li>
</ul>
<p>因此进程间通信时，站在进程的角度是对「发送方 / 接收方」与「阻塞 / 非阻塞」的自由组合，而「阻塞 / 非阻塞」与「同步 / 异步」是同义词。</p>
<hr>
<h2 id="2-进程切换"><a href="#2-进程切换" class="headerlink" title="2. 进程切换"></a>2. 进程切换</h2><p>当 Linux 从一个进程切换到另一个进程时通常包含一下几个步骤：</p>
<ul>
<li>对于运行中的进程，<strong>中断（Interrupt）</strong> 或 <strong>系统调用（System Call）</strong> 都可以将 CPU 的控制转移到内核。<ul>
<li>中断（Interrupt）：CPU 有一个中断信号位，CPU 在每个时钟周期的末尾都会检测中断信号位是否有中断信号到达，如果有则会根据中断的优先级决定是否要暂停当前执行的指令，转而去执行处理中断的指令。</li>
<li>时钟中断（Clock Interrupt）：一个硬件时钟每隔一段时间就会向 CPU 发送一个中断信号，CPU 在响应这个中断时就会去执行操作系统内核的指令，继而将 CPU 的控制转移给了内核，由内核决定下一个要被执行的指令。</li>
<li>系统调用（System Call）：操作系统提供给应用程序的接口。用户态通过 System Call 来完成那些需要内核才能执行的操作，例如硬盘、网络接口设备的 IO 等。</li>
</ul>
</li>
<li>内核会将原进程在 CPU 中的上下文（程序计数器、寄存器等）信息保存在分配给该进程的内存区域 PCB 中。</li>
<li>内核从另一个进程的 PCB 中取出其上下文信息，将 CPU 的控制转移给新进程，开始执行新进程的指令。</li>
</ul>
<p>当 CPU 在进程间切换时，由于需要在用户态和内核态之间切换，并且需要对进程的 PCB 做读写，所以会带来一定的开销，对于运行着 Unix 系统的现代 PC 而言，进程切换通常至少需要花费 300 us。</p>
<p>因此，当进程间需要通信时，CPU 需要一定的时间做数据的 IO 和进程切换，并且由于进程间内存默认不可共享，所以往往还伴随着数据的拷贝，这就导致发送进程和接收进程在这段等待时间内可以有不同的策略，也即是否阻塞。</p>
<hr>
<h2 id="3-进程间通信的模型"><a href="#3-进程间通信的模型" class="headerlink" title="3. 进程间通信的模型"></a>3. 进程间通信的模型</h2><p>在实际的进程间通信案例中，阻塞通信会使得进程的执行是顺序的，开发人员可以预知进程的执行情况。而非阻塞通信则可以提高 CPU 的利用率，换言之也就是提高性能。但在实际的进程间通信过程中，通常会考虑一个完整的进程间通信流程，此时「阻塞 / 非阻塞」更多是指通信过程中数据的流动，才会与「同步 / 异步」搭配定义。</p>
<p>但是需要明确，「同步」一定意味着「阻塞」，反之「阻塞」也一定意味着「同步」，「异步」一定意味着「非阻塞」，但「非阻塞」不一定「异步」，根据进程的执行策略而有所区别。</p>
<h3 id="3-1-同步阻塞BIO"><a href="#3-1-同步阻塞BIO" class="headerlink" title="3.1 同步阻塞BIO"></a>3.1 同步阻塞BIO</h3><p>发送进程 A 向接收进程 B 发送消息，随后 A 挂起，等待内核将消息发送给 B，处理完后内核重新唤醒 A，A 再将返回的数据从内核拷贝到进程内。</p>
<ul>
<li>A 在发送数据后挂起等待 B 接收数据，这个过程是阻塞的。</li>
<li>B 成功接收数据后，A 继续挂起等待 B 处理数据完成，这个过程也是阻塞的。</li>
<li>B 处理完成返回数据后，内核唤醒 A，A 仍然需要等待从内核将数据拷贝回用户进程，这个过程也是阻塞的。</li>
</ul>
<p>由于整个过程中，A 都处于阻塞状态，直到被唤醒后执行吓一条指令，所以从整个通信过程来看也是同步的。</p>
<h3 id="3-2-同步非阻塞NIO"><a href="#3-2-同步非阻塞NIO" class="headerlink" title="3.2 同步非阻塞NIO"></a>3.2 同步非阻塞NIO</h3><p>发送进程 A 向接收进程 B 发送消息，随后 A 立即执行其他指令，但每个一段时间就会主动发起请求，查询 B 是否成功接收数据，以及是否处理完毕返回数据，如果有返回数据，则继续执行原来的指令，并将数据从内核拷贝到进程内。</p>
<ul>
<li>A 发送数据后立即执行其他指令，不论 B 是否成功接收数据，这个过程是非阻塞的。</li>
<li>A 周期性请求内核，查询 B 是否成功接收数据，以及是否在执行完毕后返回了数据，这个过程是非阻塞的。</li>
<li>B 成功接收数据后，将状态同步给内核。B 处理完成返回后，将数据拷贝到内核空间，A 查询到后，再将返回的数据从内核拷贝到 A 进程中，这个过程是阻塞的。</li>
</ul>
<p>由于 B 返回数据后，A 需要从内核拷贝数据，这个过程仍然是阻塞的，所以从整个通信过程来看仍然是同步的。</p>
<h3 id="3-3-同步信号驱动"><a href="#3-3-同步信号驱动" class="headerlink" title="3.3 同步信号驱动"></a>3.3 同步信号驱动</h3><p>发送进程 A 向接收进程 B 发送消息，随后 A 立即执行其他指令，直到 B 处理完毕并返回数据后，由内核通知进程 A，然后 A 再从内核将数据拷贝到进程内。</p>
<ul>
<li>A 发送数据后立即执行其他指令，不论 B 是否成功接收，这个过程是非阻塞的。</li>
<li>B 处理完并返回数据后，内核通知 A，这个过程是非阻塞的。</li>
<li>A 从内核中拷贝数据到进程内，这个过程是阻塞的。</li>
</ul>
<p>虽然信号驱动模型不再需要 A 频繁主动查询 B 的数据返回状态，但由于最终仍然需要将数据从内核拷贝到 A 进程，这个过程依然是阻塞的，所以从整个通信过程来看仍然是同步的。</p>
<h3 id="3-4-同步IO多路复用"><a href="#3-4-同步IO多路复用" class="headerlink" title="3.4 同步IO多路复用"></a>3.4 同步IO多路复用</h3><p>多个发送进程向同一个管道注册，由管道完成和内核的交互。当一个进程通过 <code>select</code> 函数从管道获取数据时，如果所有被监听的 IO 的数据都没有准备好，则调用 <code>select</code> 的当前进程会进入阻塞状态，直到「任意一个」被监听的 IO 数据已准备好并返回，然后通知对应的监听进程，监听进程再从内核中将数据拷贝到进程内。</p>
<p>由于 IO 多路复用在调用 <code>select</code> 时会进入阻塞状态，并且监听进程在收到数据已准备好的通知后，仍需从内核拷贝数据到进程内，因此从整个通信过程来看仍然是同步的。</p>
<h3 id="3-5-异步非阻塞AIO"><a href="#3-5-异步非阻塞AIO" class="headerlink" title="3.5 异步非阻塞AIO"></a>3.5 异步非阻塞AIO</h3><p>进程 A 发起一个 <code>aio_read</code> 指令，将自己的「描述符」、「缓冲区指针」、「缓冲区大小」、「回调函数 / 回调信号」信息发送给内核，内核 <code>aio_read</code> 指令会立即返回，进程 A 即可执行其他指令。当 A 指令所需的数据准备好后，再由内核负责把数据拷贝到 A 的用户内存，然后再通过回调信号或基于线程的回调的方式，通知进程 A，此时 A 已经可以直接操作所需数据而不需要拷贝，是真正的异步 IO。</p>
<hr>
<h2 id="4-Java中的IO"><a href="#4-Java中的IO" class="headerlink" title="4. Java中的IO"></a>4. Java中的IO</h2><h3 id="4-1-BIO"><a href="#4-1-BIO" class="headerlink" title="4.1 BIO"></a>4.1 BIO</h3><p>BIO 面向「流」<code>Stream</code>，<code>Stream</code> 只能单项传输，Java 中对应的就是输入流 <code>InputStream</code> 和输出流 <code>OutputStream</code>。最普通的 Socket 和 ServerSocket 就基于 BIO，例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketBIO</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 启动 Server</span></span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    startService();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ignored) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 启动 Client</span></span><br><span class="line">        <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    startClient();</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException ignored) &#123;&#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">startService</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 绑定 8888 端口，最大同时连接数为 5，超出的请求会被拒绝。</span></span><br><span class="line">        ServerSocket serverSocket = <span class="keyword">new</span> ServerSocket(<span class="number">8888</span>, <span class="number">5</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// 接受一个连接，accept 是阻塞的</span></span><br><span class="line">            <span class="keyword">try</span> (Socket client = serverSocket.accept()) &#123;</span><br><span class="line">                <span class="comment">// 从客户端读取数据</span></span><br><span class="line">                BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(client.getInputStream()));</span><br><span class="line">                <span class="keyword">int</span> readLength = bufferedReader.read();</span><br><span class="line">                bufferedReader.close();</span><br><span class="line">                <span class="comment">// 向客户端发送数据</span></span><br><span class="line">                BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(client.getOutputStream()));</span><br><span class="line">                bufferedWriter.write(<span class="string">&quot;Output Content&quot;</span>);</span><br><span class="line">                bufferedWriter.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">startClient</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// 连接本地 8888 端口。</span></span><br><span class="line">            <span class="keyword">try</span> (Socket client = <span class="keyword">new</span> Socket(<span class="string">&quot;localhost&quot;</span>, <span class="number">8888</span>)) &#123;</span><br><span class="line">                <span class="comment">// 从服务端读取数据</span></span><br><span class="line">                BufferedReader bufferedReader = <span class="keyword">new</span> BufferedReader(<span class="keyword">new</span> InputStreamReader(client.getInputStream()));</span><br><span class="line">                <span class="keyword">int</span> readLength = bufferedReader.read();</span><br><span class="line">                bufferedReader.close();</span><br><span class="line">                <span class="comment">// 向服务端写入数据</span></span><br><span class="line">                BufferedWriter bufferedWriter = <span class="keyword">new</span> BufferedWriter(<span class="keyword">new</span> OutputStreamWriter(client.getOutputStream()));</span><br><span class="line">                bufferedWriter.write(<span class="string">&quot;Output Content&quot;</span>);</span><br><span class="line">                bufferedWriter.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>虽然上例中 Socket 和 ServerSocket 都用了 <code>BufferedWriter</code> 和 <code>BufferedReader</code>，但 Socket 本身提供的是输入流和输出流 <code>client#getXXXStream</code>，只是业务上再封装了一层 Buffer，所以 BIO 本质上是「流式传输」。</p>
<h3 id="4-2-NIO"><a href="#4-2-NIO" class="headerlink" title="4.2 NIO"></a>4.2 NIO</h3><p>NIO 面向「通道」<code>Channel</code>，<code>Channel</code> 支持双向传输，Java 中常见的 Channel 有：</p>
<ul>
<li><code>FileChannel</code></li>
<li><code>DatagramChannel</code></li>
<li><code>SocketChannel</code></li>
<li><code>ServerSocketChannel</code></li>
</ul>
<p><code>Channel</code> 只是一种双向通信模型，因此通常搭配 <code>Buffer</code> 一起使用，由 <code>Buffer</code> 充当实际数据的载体，Java 中常见的 Buffer 有：</p>
<ul>
<li><code>ByteBuffer</code></li>
<li><code>CharBuffer</code></li>
<li><code>ShortBuffer</code></li>
<li><code>IntBuffer</code></li>
<li><code>FloatBuffer</code></li>
<li><code>LongBuffer</code></li>
<li><code>DoubleBuffer</code></li>
</ul>
<p>SocketChannel 和 ServerSocketChannel 就基于 NIO：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SocketNIO</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 开启 Server</span></span><br><span class="line">        <span class="keyword">new</span> Thread(() -&gt; &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                startService();</span><br><span class="line">            &#125; <span class="keyword">catch</span> (IOException ignored) &#123;&#125;</span><br><span class="line">        &#125;).start();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 开启 Client</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            startClient();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException ignored) &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">startService</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 开启通道</span></span><br><span class="line">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class="line">        <span class="comment">// 绑定本地 8888 端口，最大同时连接数 5，超出后连接将被拒绝。</span></span><br><span class="line">        serverSocketChannel.socket().bind(<span class="keyword">new</span> InetSocketAddress(<span class="number">8888</span>), <span class="number">5</span>);</span><br><span class="line">        <span class="comment">// 设置 accept 时为非阻塞</span></span><br><span class="line">        serverSocketChannel.configureBlocking(<span class="keyword">false</span>);</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">// 接受一个客户端连接</span></span><br><span class="line">            SocketChannel clientChannel = serverSocketChannel.accept();</span><br><span class="line">            <span class="keyword">if</span> (clientChannel == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="comment">// 由于 serverSocketChannel.configureBlocking(false) 使得 accept 变为非阻塞，</span></span><br><span class="line">                <span class="comment">// 因此需要对 accept 返回的 SocketChannel 判空，为空说明没有客户端连接，可以执行其他指令。</span></span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 用 ByteBuffer 缓冲读取字节数据，缓冲区大小设置为 48 字节，</span></span><br><span class="line">            <span class="comment">// Buffer 默认的起始指针 start 和当前指针 current 指向 0 下标，终止指针 limit 指向末位，</span></span><br><span class="line">            <span class="comment">// 表示接下来的操作从 start 开始，当 current 指向 limit 时说明 Buffer 存满了。</span></span><br><span class="line">            ByteBuffer byteBuffer = ByteBuffer.allocate(<span class="number">48</span>);</span><br><span class="line">            <span class="comment">// 从通道中读取字节数据并写入缓冲区，此时对 Buffer 的操作是「写入」，</span></span><br><span class="line">            <span class="comment">// 每次都向 Buffer 的 current 指向的位写入一个字节，并把 current 指向下一位。</span></span><br><span class="line">            <span class="keyword">int</span> readLength = clientChannel.read(byteBuffer);</span><br><span class="line">            <span class="keyword">while</span> (readLength &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// 如果原本 Buffer 用于「写入」，则需要「读取」之前需要先将 Buffer 翻转，</span></span><br><span class="line">                <span class="comment">// 使得新 start 指向原 current，新 limit 指向原 start，</span></span><br><span class="line">                <span class="comment">// 表示接下来的操作从 Buffer 原先的 current 位置开始反向进行。</span></span><br><span class="line">                byteBuffer.flip();</span><br><span class="line">                <span class="keyword">while</span> (byteBuffer.hasRemaining()) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;Read: &quot;</span> + byteBuffer.get());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 重置 Buffer 的 start 和 current 到 0 下标，limit 到末位，</span></span><br><span class="line">                <span class="comment">// 相当于标记这个 Buffer 又可以从头重新操作。</span></span><br><span class="line">                byteBuffer.clear();</span><br><span class="line">                <span class="comment">// 继续从通道中读取数据，直到通道中没有数据为止。</span></span><br><span class="line">                readLength = clientChannel.read(byteBuffer);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">startClient</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="comment">// 开启通道</span></span><br><span class="line">        SocketChannel clientChannel = SocketChannel.open();</span><br><span class="line">        <span class="comment">// 连接到本地 8888 端口。</span></span><br><span class="line">        clientChannel.connect(<span class="keyword">new</span> InetSocketAddress(<span class="string">&quot;localhost&quot;</span>, <span class="number">8888</span>));</span><br><span class="line">        <span class="comment">// 设置缓冲区大小 48 字节。</span></span><br><span class="line">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class="number">48</span>);</span><br><span class="line">        <span class="comment">// 向 Buffer 写入数据</span></span><br><span class="line">        byteBuffer.put(<span class="string">&quot;Output Content&quot;</span>.getBytes());</span><br><span class="line">        <span class="comment">// 为了读取 Buffer 中的数据并通过 Socket 发送，需要先翻转 Buffer</span></span><br><span class="line">        byteBuffer.flip();</span><br><span class="line">        <span class="keyword">while</span> (byteBuffer.hasRemaining()) &#123;</span><br><span class="line">            clientChannel.write(byteBuffer);</span><br><span class="line">        &#125;</span><br><span class="line">        clientChannel.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><ul>
<li><a target="_blank" rel="noopener" href="https://www.zhihu.com/question/19732473/answer/241673170" title="@LINK">IO 概念区分</a></li>
<li><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/zMGt19ae0UP7NhNhBX7QUw" title="@LINK">漫话：如何给女朋友解释什么是Linux的五种IO模型？</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_38109046/article/details/89449305" title="@LINK">ava面试常考的 BIO，NIO，AIO 总结</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/oMaoYanEr/article/details/79976359" title="@LINK">Java NIO总结（一）：Channel、Buffer、Selector</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013096088/article/details/78638245" title="@LINK">Java NIO学习笔记二（Buffer的flip()方法详解）</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/he_jiawang/article/details/84792619" title="@LINK">Java——SocketChannel</a></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">

          <div class="reward-container">
  <div>reward.comment</div>
  <button>
    支持一下
  </button>
  <div class="post-reward">
      <div>
        <img src="/assets/images/reward.png" alt="LuisLiu 微信">
        <span>微信</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>LuisLiu
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://luisliu.cn/post/linux/linux-io_block/" title="Linux-IO阻塞模型">https://luisliu.cn/post/linux/linux-io_block/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>所有文章均由 Luis 原创，采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议，引用前请务必联系授权。
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/Linux/" rel="tag"><i class="fa fa-tag"></i> Linux</a>
              <a href="/tags/IO/" rel="tag"><i class="fa fa-tag"></i> IO</a>
              <a href="/tags/%E5%90%8C%E6%AD%A5/" rel="tag"><i class="fa fa-tag"></i> 同步</a>
              <a href="/tags/%E5%BC%82%E6%AD%A5/" rel="tag"><i class="fa fa-tag"></i> 异步</a>
              <a href="/tags/%E9%98%BB%E5%A1%9E/" rel="tag"><i class="fa fa-tag"></i> 阻塞</a>
              <a href="/tags/%E9%9D%9E%E9%98%BB%E5%A1%9E/" rel="tag"><i class="fa fa-tag"></i> 非阻塞</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/post/android/android-touch_event/" rel="prev" title="Android-触摸事件">
                  <i class="fa fa-angle-left"></i> Android-触摸事件
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/post/android/android-binder/" rel="next" title="Android-Binder">
                  Android-Binder <i class="fa fa-angle-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">
  <div class="languages">
    <label class="lang-select-label">
      <i class="fa fa-language"></i>
      <span>简体中文</span>
      <i class="fa fa-angle-up" aria-hidden="true"></i>
    </label>
    <select class="lang-select" data-canonical="" aria-label="选择语言">
      
        <option value="en" data-href="/post/linux/linux-io_block/" selected="">
          English
        </option>
      
        <option value="zh-CN" data-href="/zh-CN/post/linux/linux-io_block/" selected="">
          简体中文
        </option>
      
    </select>
  </div>

  <div class="copyright">
    &copy; 2018 – 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa-solid fa-at"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">LuisLiu</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>全站总字数：</span>
    <span title="全站总字数">526k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>全站总阅读时长 &asymp;</span>
    <span title="全站总阅读时长">9:44</span>
  </span>
</div>


    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="返回顶部">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/liushulun" class="github-corner" title="GitHub主页" aria-label="GitHub主页" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancyapps-ui/5.0.31/fancybox/fancybox.umd.js" integrity="sha256-a+H7FYzJv6oU2hfsfDGM2Ohw/cR9v+hPfxHCLdmCrE8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lozad.js/1.16.0/lozad.min.js" integrity="sha256-mOFREFhqmHeQbXpK2lp4nA3qooVgACfh88fpJftLBbc=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/fancybox.js"></script>

  <script src="/js/third-party/pace.js"></script>


  




  

  <script class="next-config" data-name="enableMath" type="application/json">false</script><script class="next-config" data-name="mathjax" type="application/json">{"enable":true,"tags":"none","js":{"url":"https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js","integrity":"sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI="}}</script>
<script src="/js/third-party/math/mathjax.js"></script>




<style type="text/css">
    .toBottom {
        color: #EEEEEE;
        border-bottom: none;
    }
    .toBottom:hover {
        color: #EB6D39;
        border-bottom: none;
    }
</style>





<div class="scrollToBottom back-to-top back-to-top-on" role="button" style="bottom: 61px;">
    <i class="fa fa-arrow-down fa-lg"></i>
    
</div>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const scrollToBottom = document.querySelector('.scrollToBottom');
        /* 内联写法：
        $('.scrollToBottom').click(function(){
            $('html,body').animate({scrollTop:document.body.scrollHeight}, 500);
        });
        */
        scrollToBottom && scrollToBottom.addEventListener('click', () => {
            window.anime({
            targets  : document.scrollingElement,
            duration : 500,
            easing   : 'linear',
            scrollTop: document.scrollingElement.scrollHeight
            });
        });
    });
</script>

<a id='postBottom'></a>

</body>
</html>
